ashxurl = 'http://iiqsw.mohw.gov.tw/olap/ajax/GetPivotResource.ashx' 

headers = {
    'Origin': 'http://iiqsw.mohw.gov.tw' ,
    'Accept-Encoding': 'gzip, deflate' ,
    'Accept-Language': 'zh-TW,zh;q=0.8,en-US;q=0.6,en;q=0.4' ,
    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36' ,
    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' ,
    'Accept': '*/*' ,
    'X-Requested-With': 'XMLHttpRequest' ,
    'Connection': 'keep-alive' ,
    'DNT': '1' 
    }
headers['Cookie'] = r.headers['set-cookie']

data = 'method=GetPivotData&strCondition=%7B%22city%22%3A%5B%22all%22%2C%22901%22%2C%22902%22%2C%22903%22%2C%22904%22%2C%22905%22%2C%22906%22%2C%22907%22%2C%22908%22%2C%22909%22%2C%22910%22%2C%22911%22%2C%22912%22%2C%22913%22%2C%22914%22%2C%22915%22%2C%22916%22%2C%22917%22%2C%22918%22%2C%22919%22%2C%22920%22%2C%22921%22%2C%22922%22%5D%2C%22sex%22%3A%5B%22all%22%5D%2C%22age%22%3A%5B%2223_all%22%2C%2223_000%22%2C%2223_001%22%2C%2223_002%22%2C%2223_003%22%2C%2223_004%22%2C%2223_005%22%2C%2223_006%22%2C%2223_007%22%2C%2223_008%22%2C%2223_009%22%2C%2223_010%22%2C%2223_011%22%2C%2223_012%22%2C%2223_013%22%2C%2223_014%22%2C%2223_015%22%2C%2223_016%22%2C%2223_017%22%2C%2223_018%22%2C%2223_019%22%2C%2223_020%22%2C%2223_021%22%2C%2223_022%22%2C%2223_023%22%2C%2223_024%22%2C%2223_025%22%2C%2223_026%22%2C%2223_027%22%2C%2223_028%22%2C%2223_029%22%2C%2223_030%22%2C%2223_031%22%2C%2223_032%22%2C%2223_033%22%2C%2223_034%22%2C%2223_035%22%2C%2223_036%22%2C%2223_037%22%2C%2223_038%22%2C%2223_039%22%2C%2223_040%22%2C%2223_041%22%2C%2223_042%22%2C%2223_043%22%2C%2223_044%22%2C%2223_045%22%2C%2223_046%22%2C%2223_047%22%2C%2223_048%22%2C%2223_049%22%2C%2223_050%22%2C%2223_051%22%2C%2223_052%22%2C%2223_053%22%2C%2223_054%22%2C%2223_055%22%2C%2223_056%22%2C%2223_057%22%2C%2223_058%22%2C%2223_059%22%2C%2223_060%22%2C%2223_061%22%2C%2223_062%22%2C%2223_063%22%2C%2223_064%22%2C%2223_065%22%2C%2223_066%22%2C%2223_067%22%2C%2223_068%22%2C%2223_069%22%2C%2223_070%22%2C%2223_071%22%2C%2223_072%22%2C%2223_073%22%2C%2223_074%22%2C%2223_075%22%2C%2223_076%22%2C%2223_077%22%2C%2223_078%22%2C%2223_079%22%2C%2223_080%22%2C%2223_081%22%2C%2223_082%22%2C%2223_083%22%2C%2223_084%22%2C%2223_085%22%2C%2223_086%22%2C%2223_087%22%2C%2223_088%22%2C%2223_089%22%2C%2223_090%22%2C%2223_091%22%2C%2223_092%22%2C%2223_093%22%2C%2223_094%22%2C%2223_095%22%2C%2223_096%22%2C%2223_097%22%2C%2223_098%22%2C%2223_099%22%2C%2223_100%22%5D%2C%22year%22%3A%5B%22104%22%2C%22103%22%2C%22102%22%2C%22101%22%2C%22100%22%2C%2299%22%2C%2298%22%2C%2297%22%2C%2296%22%2C%2295%22%2C%2294%22%2C%2293%22%2C%2292%22%2C%2291%22%2C%2290%22%2C%2289%22%2C%2288%22%2C%2287%22%2C%2286%22%2C%2285%22%2C%2284%22%2C%2283%22%2C%2282%22%2C%2281%22%5D%7D&strMTID=24&strTID=25&strlng=1&strselectcols=percentage%2Cpopulation%2Csex%2Cyear%2Ccity%2Cage&sortquery=%5B%22age%22%2C%22year%22%2C%22city%22%5D'
data1 = 'method=GetPivotData&strCondition=%7B%22city%22%3A%5B%220101%22%2C%220102%22%2C%220109%22%2C%220110%22%2C%220111%22%2C%220112%22%2C%220115%22%2C%220116%22%2C%220117%22%2C%220118%22%2C%220119%22%2C%220120%22%2C%220301%22%2C%220302%22%2C%220303%22%2C%220304%22%2C%220305%22%2C%220306%22%2C%220307%22%2C%220308%22%2C%220309%22%2C%220310%22%2C%220311%22%2C%220312%22%2C%220313%22%2C%220314%22%2C%220315%22%2C%220316%22%2C%220317%22%2C%220318%22%2C%220319%22%2C%220320%22%2C%220321%22%2C%220322%22%2C%220323%22%2C%220324%22%2C%220325%22%2C%220326%22%2C%220327%22%2C%220328%22%2C%220329%22%2C%220501%22%2C%220502%22%2C%220503%22%2C%220504%22%2C%220505%22%2C%220506%22%2C%220507%22%2C%220508%22%2C%220509%22%2C%220510%22%2C%220511%22%2C%220512%22%2C%220513%22%2C%220514%22%2C%220515%22%2C%220516%22%2C%220517%22%2C%220518%22%2C%220519%22%2C%220520%22%2C%220521%22%2C%220522%22%2C%220523%22%2C%220524%22%2C%220525%22%2C%220526%22%2C%220527%22%2C%220528%22%2C%220529%22%2C%220530%22%2C%220531%22%2C%220532%22%2C%220533%22%2C%220534%22%2C%220535%22%2C%220537%22%2C%220538%22%2C%220701%22%2C%220702%22%2C%220703%22%2C%220704%22%2C%220705%22%2C%220706%22%2C%220707%22%2C%220708%22%2C%220709%22%2C%220710%22%2C%220711%22%2C%220712%22%2C%220713%22%2C%220714%22%2C%220715%22%2C%220716%22%2C%220717%22%2C%220718%22%2C%220719%22%2C%220720%22%2C%220721%22%2C%220722%22%2C%220723%22%2C%220724%22%2C%220725%22%2C%220726%22%2C%220727%22%2C%220728%22%2C%220729%22%2C%220730%22%2C%220731%22%2C%220732%22%2C%220733%22%2C%220734%22%2C%220735%22%2C%220736%22%2C%220737%22%2C%220738%22%2C%221101%22%2C%221102%22%2C%221103%22%2C%221104%22%2C%221105%22%2C%221106%22%2C%221107%22%2C%221201%22%2C%221204%22%2C%221205%22%2C%222201%22%2C%222202%22%2C%223101%22%2C%223102%22%2C%223103%22%2C%223104%22%2C%223105%22%2C%223106%22%2C%223107%22%2C%223108%22%2C%223109%22%2C%223110%22%2C%223111%22%2C%223112%22%2C%223113%22%2C%223114%22%2C%223115%22%2C%223116%22%2C%223117%22%2C%223118%22%2C%223119%22%2C%223120%22%2C%223121%22%2C%223122%22%2C%223123%22%2C%223124%22%2C%223125%22%2C%223126%22%2C%223127%22%2C%223128%22%2C%223129%22%2C%223201%22%2C%223202%22%2C%223203%22%2C%223204%22%2C%223205%22%2C%223206%22%2C%223207%22%2C%223208%22%2C%223209%22%2C%223210%22%2C%223211%22%2C%223212%22%2C%223213%22%2C%223301%22%2C%223302%22%2C%223303%22%2C%223305%22%2C%223306%22%2C%223307%22%2C%223308%22%2C%223309%22%2C%223310%22%2C%223311%22%2C%223312%22%2C%223313%22%2C%223314%22%2C%223401%22%2C%223402%22%2C%223403%22%2C%223404%22%2C%223405%22%2C%223406%22%2C%223407%22%2C%223408%22%2C%223409%22%2C%223410%22%2C%223411%22%2C%223412%22%2C%223501%22%2C%223502%22%2C%223503%22%2C%223504%22%2C%223505%22%2C%223506%22%2C%223507%22%2C%223508%22%2C%223509%22%2C%223510%22%2C%223511%22%2C%223512%22%2C%223513%22%2C%223514%22%2C%223515%22%2C%223516%22%2C%223517%22%2C%223518%22%2C%223701%22%2C%223702%22%2C%223703%22%2C%223704%22%2C%223705%22%2C%223706%22%2C%223707%22%2C%223708%22%2C%223709%22%2C%223710%22%2C%223711%22%2C%223712%22%2C%223713%22%2C%223714%22%2C%223715%22%2C%223716%22%2C%223717%22%2C%223718%22%2C%223719%22%2C%223720%22%2C%223721%22%2C%223722%22%2C%223723%22%2C%223724%22%2C%223725%22%2C%223726%22%2C%223801%22%2C%223802%22%2C%223803%22%2C%223804%22%2C%223805%22%2C%223806%22%2C%223807%22%2C%223808%22%2C%223809%22%2C%223810%22%2C%223811%22%2C%223812%22%2C%223813%22%2C%223901%22%2C%223902%22%2C%223903%22%2C%223904%22%2C%223905%22%2C%223906%22%2C%223907%22%2C%223908%22%2C%223909%22%2C%223910%22%2C%223911%22%2C%223912%22%2C%223913%22%2C%223914%22%2C%223915%22%2C%223916%22%2C%223917%22%2C%223918%22%2C%223919%22%2C%223920%22%2C%224001%22%2C%224002%22%2C%224003%22%2C%224004%22%2C%224005%22%2C%224006%22%2C%224007%22%2C%224008%22%2C%224009%22%2C%224010%22%2C%224011%22%2C%224012%22%2C%224013%22%2C%224014%22%2C%224015%22%2C%224016%22%2C%224017%22%2C%224018%22%2C%224301%22%2C%224302%22%2C%224303%22%2C%224304%22%2C%224305%22%2C%224306%22%2C%224307%22%2C%224308%22%2C%224309%22%2C%224310%22%2C%224311%22%2C%224312%22%2C%224313%22%2C%224314%22%2C%224315%22%2C%224316%22%2C%224317%22%2C%224318%22%2C%224319%22%2C%224320%22%2C%224321%22%2C%224322%22%2C%224323%22%2C%224324%22%2C%224325%22%2C%224326%22%2C%224327%22%2C%224328%22%2C%224329%22%2C%224330%22%2C%224331%22%2C%224332%22%2C%224333%22%2C%224401%22%2C%224402%22%2C%224403%22%2C%224404%22%2C%224405%22%2C%224406%22%2C%224501%22%2C%224502%22%2C%224503%22%2C%224504%22%2C%224505%22%2C%224506%22%2C%224507%22%2C%224508%22%2C%224509%22%2C%224510%22%2C%224511%22%2C%224512%22%2C%224513%22%2C%224601%22%2C%224602%22%2C%224603%22%2C%224604%22%2C%224605%22%2C%224606%22%2C%224607%22%2C%224608%22%2C%224609%22%2C%224610%22%2C%224611%22%2C%224612%22%2C%224613%22%2C%224614%22%2C%224615%22%2C%224616%22%2C%229001%22%2C%229002%22%2C%229003%22%2C%229004%22%2C%229005%22%2C%229006%22%2C%229101%22%2C%229102%22%2C%229103%22%2C%229104%22%5D%2C%22hc%22%3A%5B%223%22%2C%221%22%2C%222%22%5D%2C%22year%22%3A%5B%22103%22%2C%22102%22%2C%22101%22%2C%22100%22%2C%2299%22%2C%2298%22%2C%2297%22%2C%2296%22%2C%2295%22%2C%2294%22%2C%2293%22%5D%7D&strMTID=10&strTID=11&strlng=1&strselectcols=number%2Cyear%2Chc%2Ccity&sortquery=%5B%22city%22%2C%22year%22%2C%22hc%22%5D'

r2 = requests.post(ashxurl , verify=False, headers=headers, data=data)
json.dumps(r2.json(), ensure_ascii=False)
